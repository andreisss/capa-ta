{"meta": {"timestamp": "2024-02-27T01:36:13.972162", "version": "7.0.1", "argv": ["-r", "/opt/capa-rules-7.0.1/", "-j", "/tmp/dbnmpntw.dll"], "sample": {"md5": "b92f6c39e13b0fa57b20d81350605963", "sha1": "965f7059ad3ff8e4a0a6b6484710959b3f59b32f", "sha256": "9cf3e0725c6228be2810087e66fc509491659e20d1f003c87788bdca7811587c", "path": "/tmp/dbnmpntw.dll"}, "flavor": "static", "analysis": {"format": "pe", "arch": "amd64", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/opt/capa-rules-7.0.1"], "base_address": {"type": "absolute", "value": 6442450944}, "layout": {"functions": [{"address": {"type": "absolute", "value": 6442455056}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455103}}]}, {"address": {"type": "absolute", "value": 6442455116}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455202}}, {"address": {"type": "absolute", "value": 6442455234}}, {"address": {"type": "absolute", "value": 6442455285}}, {"address": {"type": "absolute", "value": 6442455440}}, {"address": {"type": "absolute", "value": 6442455552}}, {"address": {"type": "absolute", "value": 6442455569}}, {"address": {"type": "absolute", "value": 6442455637}}, {"address": {"type": "absolute", "value": 6442455682}}]}, {"address": {"type": "absolute", "value": 6442455728}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455728}}, {"address": {"type": "absolute", "value": 6442455761}}, {"address": {"type": "absolute", "value": 6442455796}}, {"address": {"type": "absolute", "value": 6442456392}}]}, {"address": {"type": "absolute", "value": 6442455796}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455796}}, {"address": {"type": "absolute", "value": 6442456392}}]}, {"address": {"type": "absolute", "value": 6442457104}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457114}}]}, {"address": {"type": "absolute", "value": 6442457440}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457440}}, {"address": {"type": "absolute", "value": 6442457520}}, {"address": {"type": "absolute", "value": 6442457682}}, {"address": {"type": "absolute", "value": 6442457876}}]}, {"address": {"type": "absolute", "value": 6442457920}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458027}}, {"address": {"type": "absolute", "value": 6442458143}}, {"address": {"type": "absolute", "value": 6442458195}}, {"address": {"type": "absolute", "value": 6442458247}}, {"address": {"type": "absolute", "value": 6442458572}}]}, {"address": {"type": "absolute", "value": 6442458608}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458746}}, {"address": {"type": "absolute", "value": 6442458954}}]}, {"address": {"type": "absolute", "value": 6442458992}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459120}}, {"address": {"type": "absolute", "value": 6442459337}}, {"address": {"type": "absolute", "value": 6442459395}}]}, {"address": {"type": "absolute", "value": 6442459488}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459779}}]}, {"address": {"type": "absolute", "value": 6442459824}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459824}}, {"address": {"type": "absolute", "value": 6442460063}}, {"address": {"type": "absolute", "value": 6442460285}}, {"address": {"type": "absolute", "value": 6442460313}}, {"address": {"type": "absolute", "value": 6442460507}}, {"address": {"type": "absolute", "value": 6442460631}}, {"address": {"type": "absolute", "value": 6442460689}}]}, {"address": {"type": "absolute", "value": 6442460816}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442461172}}]}, {"address": {"type": "absolute", "value": 6442461216}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442461216}}, {"address": {"type": "absolute", "value": 6442461448}}, {"address": {"type": "absolute", "value": 6442461509}}, {"address": {"type": "absolute", "value": 6442461760}}, {"address": {"type": "absolute", "value": 6442461918}}, {"address": {"type": "absolute", "value": 6442462167}}, {"address": {"type": "absolute", "value": 6442462271}}, {"address": {"type": "absolute", "value": 6442462346}}, {"address": {"type": "absolute", "value": 6442462644}}, {"address": {"type": "absolute", "value": 6442462756}}]}, {"address": {"type": "absolute", "value": 6442462896}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442462896}}, {"address": {"type": "absolute", "value": 6442462939}}, {"address": {"type": "absolute", "value": 6442463205}}, {"address": {"type": "absolute", "value": 6442463215}}, {"address": {"type": "absolute", "value": 6442463317}}, {"address": {"type": "absolute", "value": 6442463332}}, {"address": {"type": "absolute", "value": 6442463435}}, {"address": {"type": "absolute", "value": 6442463465}}]}, {"address": {"type": "absolute", "value": 6442463504}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442463504}}, {"address": {"type": "absolute", "value": 6442463545}}, {"address": {"type": "absolute", "value": 6442463601}}, {"address": {"type": "absolute", "value": 6442463811}}, {"address": {"type": "absolute", "value": 6442463820}}, {"address": {"type": "absolute", "value": 6442463867}}, {"address": {"type": "absolute", "value": 6442463929}}, {"address": {"type": "absolute", "value": 6442463956}}, {"address": {"type": "absolute", "value": 6442464056}}, {"address": {"type": "absolute", "value": 6442464076}}]}, {"address": {"type": "absolute", "value": 6442464144}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442464144}}, {"address": {"type": "absolute", "value": 6442464259}}, {"address": {"type": "absolute", "value": 6442464544}}, {"address": {"type": "absolute", "value": 6442464757}}, {"address": {"type": "absolute", "value": 6442464977}}, {"address": {"type": "absolute", "value": 6442465122}}]}, {"address": {"type": "absolute", "value": 6442465184}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442465184}}, {"address": {"type": "absolute", "value": 6442465312}}, {"address": {"type": "absolute", "value": 6442465658}}, {"address": {"type": "absolute", "value": 6442465772}}, {"address": {"type": "absolute", "value": 6442465807}}]}, {"address": {"type": "absolute", "value": 6442465840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442465984}}, {"address": {"type": "absolute", "value": 6442466333}}, {"address": {"type": "absolute", "value": 6442466474}}, {"address": {"type": "absolute", "value": 6442466531}}, {"address": {"type": "absolute", "value": 6442466553}}]}, {"address": {"type": "absolute", "value": 6442466592}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442466592}}, {"address": {"type": "absolute", "value": 6442466667}}, {"address": {"type": "absolute", "value": 6442466717}}]}, {"address": {"type": "absolute", "value": 6442466752}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442466784}}]}, {"address": {"type": "absolute", "value": 6442466960}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442466976}}]}, {"address": {"type": "absolute", "value": 6442467168}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467188}}, {"address": {"type": "absolute", "value": 6442467252}}, {"address": {"type": "absolute", "value": 6442467314}}]}, {"address": {"type": "absolute", "value": 6442467408}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467408}}, {"address": {"type": "absolute", "value": 6442467433}}, {"address": {"type": "absolute", "value": 6442467465}}]}, {"address": {"type": "absolute", "value": 6442467664}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467664}}, {"address": {"type": "absolute", "value": 6442467704}}, {"address": {"type": "absolute", "value": 6442467763}}, {"address": {"type": "absolute", "value": 6442467807}}]}, {"address": {"type": "absolute", "value": 6442467824}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467824}}, {"address": {"type": "absolute", "value": 6442467865}}, {"address": {"type": "absolute", "value": 6442467922}}, {"address": {"type": "absolute", "value": 6442467957}}]}, {"address": {"type": "absolute", "value": 6442467984}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442467984}}, {"address": {"type": "absolute", "value": 6442468019}}, {"address": {"type": "absolute", "value": 6442468067}}]}, {"address": {"type": "absolute", "value": 6442468672}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468672}}, {"address": {"type": "absolute", "value": 6442468746}}]}, {"address": {"type": "absolute", "value": 6442468756}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468756}}, {"address": {"type": "absolute", "value": 6442468830}}]}, {"address": {"type": "absolute", "value": 6442468840}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468840}}, {"address": {"type": "absolute", "value": 6442468914}}]}, {"address": {"type": "absolute", "value": 6442468924}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442468924}}, {"address": {"type": "absolute", "value": 6442468998}}]}, {"address": {"type": "absolute", "value": 6442469008}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469008}}, {"address": {"type": "absolute", "value": 6442469082}}]}, {"address": {"type": "absolute", "value": 6442469092}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469092}}, {"address": {"type": "absolute", "value": 6442469172}}]}, {"address": {"type": "absolute", "value": 6442469185}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469185}}, {"address": {"type": "absolute", "value": 6442469274}}]}, {"address": {"type": "absolute", "value": 6442469287}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469287}}, {"address": {"type": "absolute", "value": 6442469376}}]}, {"address": {"type": "absolute", "value": 6442469389}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442469389}}, {"address": {"type": "absolute", "value": 6442469417}}]}]}, "feature_counts": {"file": 525, "functions": [{"address": {"type": "absolute", "value": 6442455056}, "count": 27}, {"address": {"type": "absolute", "value": 6442455116}, "count": 83}, {"address": {"type": "absolute", "value": 6442455728}, "count": 66}, {"address": {"type": "absolute", "value": 6442455796}, "count": 59}, {"address": {"type": "absolute", "value": 6442456903}, "count": 8}, {"address": {"type": "absolute", "value": 6442456915}, "count": 8}, {"address": {"type": "absolute", "value": 6442457104}, "count": 26}, {"address": {"type": "absolute", "value": 6442457374}, "count": 8}, {"address": {"type": "absolute", "value": 6442457408}, "count": 7}, {"address": {"type": "absolute", "value": 6442457440}, "count": 93}, {"address": {"type": "absolute", "value": 6442457920}, "count": 96}, {"address": {"type": "absolute", "value": 6442458608}, "count": 84}, {"address": {"type": "absolute", "value": 6442458992}, "count": 96}, {"address": {"type": "absolute", "value": 6442459424}, "count": 16}, {"address": {"type": "absolute", "value": 6442459472}, "count": 8}, {"address": {"type": "absolute", "value": 6442459488}, "count": 78}, {"address": {"type": "absolute", "value": 6442459824}, "count": 162}, {"address": {"type": "absolute", "value": 6442460816}, "count": 85}, {"address": {"type": "absolute", "value": 6442461216}, "count": 168}, {"address": {"type": "absolute", "value": 6442462896}, "count": 112}, {"address": {"type": "absolute", "value": 6442463504}, "count": 114}, {"address": {"type": "absolute", "value": 6442464112}, "count": 12}, {"address": {"type": "absolute", "value": 6442464144}, "count": 143}, {"address": {"type": "absolute", "value": 6442465168}, "count": 8}, {"address": {"type": "absolute", "value": 6442465184}, "count": 107}, {"address": {"type": "absolute", "value": 6442465840}, "count": 115}, {"address": {"type": "absolute", "value": 6442466592}, "count": 49}, {"address": {"type": "absolute", "value": 6442466752}, "count": 63}, {"address": {"type": "absolute", "value": 6442466960}, "count": 61}, {"address": {"type": "absolute", "value": 6442467168}, "count": 65}, {"address": {"type": "absolute", "value": 6442467408}, "count": 37}, {"address": {"type": "absolute", "value": 6442467504}, "count": 45}, {"address": {"type": "absolute", "value": 6442467664}, "count": 56}, {"address": {"type": "absolute", "value": 6442467824}, "count": 49}, {"address": {"type": "absolute", "value": 6442467984}, "count": 53}, {"address": {"type": "absolute", "value": 6442468597}, "count": 8}, {"address": {"type": "absolute", "value": 6442468656}, "count": 9}, {"address": {"type": "absolute", "value": 6442468672}, "count": 26}, {"address": {"type": "absolute", "value": 6442468756}, "count": 26}, {"address": {"type": "absolute", "value": 6442468840}, "count": 26}, {"address": {"type": "absolute", "value": 6442468924}, "count": 26}, {"address": {"type": "absolute", "value": 6442469008}, "count": 26}, {"address": {"type": "absolute", "value": 6442469092}, "count": 26}, {"address": {"type": "absolute", "value": 6442469185}, "count": 26}, {"address": {"type": "absolute", "value": 6442469287}, "count": 26}, {"address": {"type": "absolute", "value": 6442469389}, "count": 24}]}, "library_functions": [{"address": {"type": "absolute", "value": 6442456432}, "name": "__security_check_cookie"}, {"address": {"type": "absolute", "value": 6442456468}, "name": "__raise_securityfailure"}, {"address": {"type": "absolute", "value": 6442456528}, "name": "__report_gsfailure"}, {"address": {"type": "absolute", "value": 6442456928}, "name": "_FindPESection"}, {"address": {"type": "absolute", "value": 6442457008}, "name": "_IsNonwritableInCurrentImage"}, {"address": {"type": "absolute", "value": 6442457156}, "name": "__security_init_cookie"}, {"address": {"type": "absolute", "value": 6442468464}, "name": "__GSHandlerCheck"}, {"address": {"type": "absolute", "value": 6442468500}, "name": "__GSHandlerCheckCommon"}, {"address": {"type": "absolute", "value": 6442468624}, "name": "_guard_dispatch_icall_nop"}, {"address": {"type": "absolute", "value": 6442469440}, "name": "?"}]}}, "rules": {"delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scopes": {"static": "basic block", "dynamic": "call"}, "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 6442455202}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [{"type": "absolute", "value": 6442455207}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442455440}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [{"type": "absolute", "value": 6442455445}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457520}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457535}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457682}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457694}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458027}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458045}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458143}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458174}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458195}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458226}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458247}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458278}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442461509}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442461522}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442461760}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442461775}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442461918}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442461930}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442462167}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462169}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442462346}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462353}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442462644}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462651}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442462756}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462768}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464259}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442464272}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464544}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442464557}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464977}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442464984}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465312}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465330}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465658}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465670}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465772}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465784}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465984}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466002}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466333}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466345}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466474}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466486}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466531}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466536}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466784}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466796}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466976}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466988}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467188}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [{"type": "absolute", "value": 6442467200}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create or open file": {"meta": {"name": "create or open file", "authors": ["michael.hunhoff@mandiant.com", "joakim@intezer.com"], "scopes": {"static": "basic block", "dynamic": "call"}, "attack": [], "mbc": [{"parts": ["File System", "Create File"], "objective": "File System", "behavior": "Create File", "method": "", "id": "C0016"}], "references": [], "examples": ["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n", "matches": [[{"type": "absolute", "value": 6442460063}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460063}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "IoCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "IoCreateFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtOpenFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LZCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LZOpenFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fopen"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fopen64"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fdopen"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "freopen"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "open"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "openat"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460285}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460285}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "IoCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "IoCreateFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtOpenFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LZCreateFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LZOpenFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fopen"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fopen64"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fdopen"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "freopen"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "open"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "openat"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "create thread": {"meta": {"name": "create thread", "namespace": "host-interaction/thread/create", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scopes": {"static": "basic block", "dynamic": "thread"}, "attack": [], "mbc": [{"parts": ["Process", "Create Thread"], "objective": "Process", "behavior": "Create Thread", "method": "", "id": "C0038"}], "references": [], "examples": ["946A99F36A46D335DEC080D9A4371940:0x10001DA0", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n", "matches": [[{"type": "absolute", "value": 6442460507}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "pthread_create"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Threading.Thread::Start"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Threading.Thread::ctor"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateThread"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460555}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_beginthread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_beginthreadex"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "PsCreateSystemThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHCreateThreadWithHandle"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateRemoteThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateRemoteThreadEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlCreateUserThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateThreadEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateThreadEx"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460631}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "pthread_create"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Threading.Thread::Start"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Threading.Thread::ctor"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateThread"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460665}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_beginthread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_beginthreadex"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "PsCreateSystemThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHCreateThreadWithHandle"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateRemoteThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateRemoteThreadEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlCreateUserThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateThreadEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateThreadEx"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460689}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "pthread_create"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Threading.Thread::Start"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Threading.Thread::ctor"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateThread"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460723}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_beginthread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_beginthreadex"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "PsCreateSystemThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHCreateThreadWithHandle"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateRemoteThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CreateRemoteThreadEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlCreateUserThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateThreadEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateThread"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateThreadEx"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scopes": {"static": "function"}, "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 6442455116}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442455116}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457440}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457520}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458608}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458608}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458704}, {"type": "absolute", "value": 6442458736}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458992}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458992}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442459110}, {"type": "absolute", "value": 6442459079}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442459488}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442459584}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460816}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460914}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442461216}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442461216}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442461760}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442462896}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462896}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442463237}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442463504}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442463504}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442463843}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464144}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442464144}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465184}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465312}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465840}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465840}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465984}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466752}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466752}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466960}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466960}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467168}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442467168}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467504}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442467504}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "parse PE header": {"meta": {"name": "parse PE header", "namespace": "load-code/pe", "authors": ["moritz.raabe@mandiant.com"], "scopes": {"static": "function"}, "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x403DD0"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n", "matches": [[{"type": "absolute", "value": 6442457104}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "mnemonic", "mnemonic": "cmp"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457136}, {"type": "absolute", "value": 6442457121}, {"type": "absolute", "value": 6442457109}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "number", "number": 17744, "description": "IMAGE_NT_SIGNATURE (PE)"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457121}], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "number", "number": 80}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "number", "number": 69}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "number", "number": 23117, "description": "IMAGE_DOS_SIGNATURE (MZ)"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457104}], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "number", "number": 77}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "number", "number": 90}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "operand offset", "index": 1, "operand_offset": 60, "description": "IMAGE_DOS_HEADER.e_lfanew"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457114}], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "arch", "arch": "i386"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "operand offset", "index": 1, "operand_offset": 52, "description": "IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "arch", "arch": "amd64"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "operand offset", "index": 1, "operand_offset": 80, "description": "IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "operand offset", "index": 1, "operand_offset": 48, "description": "IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "parse PE header/66ae87bbecc5465fbc4b0f42a1cd45dd"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query environment variable": {"meta": {"name": "query environment variable", "namespace": "host-interaction/environment-variable", "authors": ["michael.hunhoff@mandiant.com", "@_re_fox"], "scopes": {"static": "function", "dynamic": "call"}, "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x401880", "0761142efbda6c4b1e801223de723578:0x65483490"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n", "matches": [[{"type": "absolute", "value": 6442459488}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetEnvironmentVariable"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetEnvironmentStrings"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ExpandEnvironmentStrings"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "getenv"}}, "children": [], "locations": [{"type": "absolute", "value": 6442459694}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "getenv"}}, "children": [], "locations": [{"type": "absolute", "value": 6442459694}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariable"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Environment::GetEnvironmentVariables"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.Environment::ExpandEnvironmentVariables"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get hostname": {"meta": {"name": "get hostname", "namespace": "host-interaction/os/hostname", "authors": ["moritz.raabe@mandiant.com", "joakim@intezer.com", "anushka.virgaonkar@mandiant.com"], "scopes": {"static": "function", "dynamic": "call"}, "attack": [{"parts": ["Discovery", "System Information Discovery"], "tactic": "Discovery", "technique": "System Information Discovery", "subtechnique": "", "id": "T1082"}], "mbc": [{"parts": ["Discovery", "System Information Discovery"], "objective": "Discovery", "behavior": "System Information Discovery", "method": "", "id": "E1082"}], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x4052A0", "7351f8a40c5450557b24622417fc478d:0x405438"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n", "matches": [[{"type": "absolute", "value": 6442459488}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "GetComputerName"}}, "children": [], "locations": [{"type": "absolute", "value": 6442459614}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetComputerNameEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetComputerObjectName"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "gethostname"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "gethostname"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "property", "access": "read", "property": "System.Environment::MachineName"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460816}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "GetComputerName"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460945}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetComputerNameEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetComputerObjectName"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "gethostname"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "gethostname"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "property", "access": "read", "property": "System.Environment::MachineName"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read pipe": {"meta": {"name": "read pipe", "namespace": "communication/named-pipe/read", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scopes": {"static": "function", "dynamic": "thread"}, "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Read Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Read Pipe", "id": "C0003.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 14-02.exe_:0x4014C0"], "description": "PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read pipe\n    namespace: communication/named-pipe/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    description: PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Interprocess Communication::Read Pipe [C0003.003]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4014C0\n  features:\n    - or:\n      - and:\n        - api: kernel32.PeekNamedPipe\n        - api: kernel32.ReadFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n", "matches": [[{"type": "absolute", "value": 6442461216}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "TransactNamedPipe", "description": "writes and reads pipe in single operation"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "PeekNamedPipe"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462553}, {"type": "absolute", "value": 6442462071}], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462251}, {"type": "absolute", "value": 6442461323}], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442464144}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "TransactNamedPipe", "description": "writes and reads pipe in single operation"}}, "children": [], "locations": [{"type": "absolute", "value": 6442464477}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "PeekNamedPipe"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFile"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466960}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "TransactNamedPipe", "description": "writes and reads pipe in single operation"}}, "children": [], "locations": [{"type": "absolute", "value": 6442467065}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "PeekNamedPipe"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFile"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "read file on Windows": {"meta": {"name": "read file on Windows", "namespace": "host-interaction/file-system/read", "authors": ["moritz.raabe@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scopes": {"static": "function", "dynamic": "thread"}, "attack": [], "mbc": [{"parts": ["File System", "Read File"], "objective": "File System", "behavior": "Read File", "method": "", "id": "C0051"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n", "matches": [[{"type": "absolute", "value": 6442461216}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadLines"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "create or open file"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442462251}, {"type": "absolute", "value": 6442461323}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtReadFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwReadFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LZRead"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_read"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466752}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllBytes"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllBytesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::ReadLines"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "number", "number": 2147483648, "description": "GENERIC_READ"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "create or open file"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466857}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ReadFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtReadFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwReadFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LZRead"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_read"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scopes": {"static": "function"}, "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 6442462896}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "GetProcAddress"}}, "children": [], "locations": [{"type": "absolute", "value": 6442463028}, {"type": "absolute", "value": 6442463053}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LdrGetProcedureAddress"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "indirect call"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LoadLibrary"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetModuleHandle"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetModuleHandleEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LdrLoadDll"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442463504}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "GetProcAddress"}}, "children": [], "locations": [{"type": "absolute", "value": 6442463641}, {"type": "absolute", "value": 6442463666}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LdrGetProcedureAddress"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "indirect call"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LoadLibrary"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetModuleHandle"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetModuleHandleEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LdrLoadDll"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write pipe": {"meta": {"name": "write pipe", "namespace": "communication/named-pipe/write", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scopes": {"static": "function", "dynamic": "thread"}, "attack": [], "mbc": [{"parts": ["Communication", "Interprocess Communication", "Write Pipe"], "objective": "Communication", "behavior": "Interprocess Communication", "method": "Write Pipe", "id": "C0003.004"}], "references": [], "examples": ["C91887D861D9BD4A5872249B641BC9F9:0x401A77"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write pipe\n    namespace: communication/named-pipe/write\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Interprocess Communication::Write Pipe [C0003.004]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n  features:\n    - or:\n      - and:\n        - or:\n          - match: create pipe\n          - match: connect pipe\n        - api: kernel32.WriteFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n", "matches": [[{"type": "absolute", "value": 6442464144}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "TransactNamedPipe", "description": "writes and reads pipe in single operation"}}, "children": [], "locations": [{"type": "absolute", "value": 6442464477}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "create pipe"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "connect pipe"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFile"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442466960}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "TransactNamedPipe", "description": "writes and reads pipe in single operation"}}, "children": [], "locations": [{"type": "absolute", "value": 6442467065}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "CallNamedPipe", "description": "connects, writes, and reads pipe in single operation"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "create pipe"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "connect pipe"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFile"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "write file on Windows": {"meta": {"name": "write file on Windows", "namespace": "host-interaction/file-system/write", "authors": ["william.ballenthin@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scopes": {"static": "function", "dynamic": "thread"}, "attack": [], "mbc": [{"parts": ["File System", "Writes File"], "objective": "File System", "behavior": "Writes File", "method": "", "id": "C0052"}], "references": [], "examples": ["Practical Malware Analysis Lab 01-04.exe_:0x4011FC", "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n", "matches": [[{"type": "absolute", "value": 6442465184}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "write file on Windows/8d88346cbcb1491da8d58aeee4f27cf7"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "write file on Windows/f59973cb949d45439510dacfe677b50f"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442465259}, {"type": "absolute", "value": 6442465533}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtWriteFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwWriteFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_fwrite"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fwrite"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442465840}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "write file on Windows/8d88346cbcb1491da8d58aeee4f27cf7"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "write file on Windows/f59973cb949d45439510dacfe677b50f"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466185}, {"type": "absolute", "value": 6442465935}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtWriteFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwWriteFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_fwrite"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fwrite"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442467168}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllBytes"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllBytesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::WriteAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllLines"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllLinesAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendAllTextAsync"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.File::AppendText"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "System.IO.FileInfo::AppendText"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "write file on Windows/8d88346cbcb1491da8d58aeee4f27cf7"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "write file on Windows/f59973cb949d45439510dacfe677b50f"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFile"}}, "children": [], "locations": [{"type": "absolute", "value": 6442467279}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WriteFileEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtWriteFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwWriteFile"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "_fwrite"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "fwrite"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "get OS version": {"meta": {"name": "get OS version", "authors": ["@mr-tz"], "scopes": {"static": "function", "dynamic": "call"}, "attack": [], "mbc": [], "references": [], "examples": ["493167E85E45363D09495D0841C30648:0x401000", "5f66b82558ca92e54e77f216ef4c066c:0x44580A"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n      - api: GetProductInfo\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - or:\n              - offset: 0xA4 = PEB->OSMajorVersion\n              - offset: 0xA8 = PEB->OSMinorVersion\n              - offset: 0xAC = PEB->OSBuildNumber\n          - and:\n            - arch: amd64\n            - or:\n              - offset: 0x118 = PEB->OSMajorVersion\n              - offset: 0x11C = PEB->OSMinorVersion\n              - offset: 0x120 = PEB->OSBuildNumber\n", "matches": [[{"type": "absolute", "value": 6442466592}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlGetVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "PsGetVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "GetVersionEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442466645}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "VerifyVersionInfo"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "VerSetConditionMask"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlGetNtVersionNumbers"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetProductInfo"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "match", "match": "PEB access"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "arch", "arch": "i386"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "offset", "offset": 164, "description": "PEB->OSMajorVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "offset", "offset": 168, "description": "PEB->OSMinorVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "offset", "offset": 172, "description": "PEB->OSBuildNumber"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "arch", "arch": "amd64"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "offset", "offset": 280, "description": "PEB->OSMajorVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "offset", "offset": 284, "description": "PEB->OSMinorVersion"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "offset", "offset": 288, "description": "PEB->OSBuildNumber"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}}}