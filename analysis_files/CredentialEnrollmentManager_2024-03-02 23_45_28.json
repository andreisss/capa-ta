{
    "md5": "b7bde7ebac05ea83e9bd51a4b84a8b49",
    "sha1": "44754c0ed3f42a0b98287e139767cc40179be80b",
    "sha256": "72daa0f5f3115b853a57c288040ec49afe27f4d547106a23f0b38389286f1ec1",
    "path": "/tmp/CredentialEnrollmentManager.exe",
    "flavor": "static",
    "format": "pe",
    "arch": "amd64",
    "os": "windows",
    "file_hash": "72daa0f5f3115b853a57c288040ec49afe27f4d547106a23f0b38389286f1ec1",
    "ATT&CK": [
        {
            "parts": [
                "Defense Evasion",
                "Obfuscated Files or Information"
            ],
            "tactic": "Defense Evasion",
            "technique": "Obfuscated Files or Information",
            "subtechnique": "",
            "id": "T1027"
        },
        {
            "parts": [
                "Discovery",
                "System Network Configuration Discovery",
                "Internet Connection Discovery"
            ],
            "tactic": "Discovery",
            "technique": "System Network Configuration Discovery",
            "subtechnique": "Internet Connection Discovery",
            "id": "T1016.001"
        },
        {
            "parts": [
                "Execution",
                "Shared Modules"
            ],
            "tactic": "Execution",
            "technique": "Shared Modules",
            "subtechnique": "",
            "id": "T1129"
        },
        {
            "parts": [
                "Discovery",
                "File and Directory Discovery"
            ],
            "tactic": "Discovery",
            "technique": "File and Directory Discovery",
            "subtechnique": "",
            "id": "T1083"
        },
        {
            "parts": [
                "Discovery",
                "Query Registry"
            ],
            "tactic": "Discovery",
            "technique": "Query Registry",
            "subtechnique": "",
            "id": "T1012"
        },
        {
            "parts": [
                "Defense Evasion",
                "Modify Registry"
            ],
            "tactic": "Defense Evasion",
            "technique": "Modify Registry",
            "subtechnique": "",
            "id": "T1112"
        },
        {
            "parts": [
                "Discovery",
                "System Owner/User Discovery"
            ],
            "tactic": "Discovery",
            "technique": "System Owner/User Discovery",
            "subtechnique": "",
            "id": "T1033"
        },
        {
            "parts": [
                "Discovery",
                "Account Discovery"
            ],
            "tactic": "Discovery",
            "technique": "Account Discovery",
            "subtechnique": "",
            "id": "T1087"
        },
        {
            "parts": [
                "Discovery",
                "System Information Discovery"
            ],
            "tactic": "Discovery",
            "technique": "System Information Discovery",
            "subtechnique": "",
            "id": "T1082"
        }
    ],
    "MBC": [
        {
            "parts": [
                "Anti-Behavioral Analysis",
                "Dynamic Analysis Evasion",
                "Delayed Execution"
            ],
            "objective": "Anti-Behavioral Analysis",
            "behavior": "Dynamic Analysis Evasion",
            "method": "Delayed Execution",
            "id": "B0003.003"
        },
        {
            "parts": [
                "Process",
                "Open Process"
            ],
            "objective": "Process",
            "behavior": "Open Process",
            "method": "",
            "id": "C0065"
        },
        {
            "parts": [
                "Operating System",
                "Registry",
                "Create Registry Key"
            ],
            "objective": "Operating System",
            "behavior": "Registry",
            "method": "Create Registry Key",
            "id": "C0036.004"
        },
        {
            "parts": [
                "Operating System",
                "Registry",
                "Open Registry Key"
            ],
            "objective": "Operating System",
            "behavior": "Registry",
            "method": "Open Registry Key",
            "id": "C0036.003"
        },
        {
            "parts": [
                "Defense Evasion",
                "Obfuscated Files or Information",
                "Encoding-Standard Algorithm"
            ],
            "objective": "Defense Evasion",
            "behavior": "Obfuscated Files or Information",
            "method": "Encoding-Standard Algorithm",
            "id": "E1027.m02"
        },
        {
            "parts": [
                "Data",
                "Encode Data",
                "XOR"
            ],
            "objective": "Data",
            "behavior": "Encode Data",
            "method": "XOR",
            "id": "C0026.002"
        },
        {
            "parts": [
                "Anti-Behavioral Analysis",
                "Debugger Detection",
                "Process Environment Block"
            ],
            "objective": "Anti-Behavioral Analysis",
            "behavior": "Debugger Detection",
            "method": "Process Environment Block",
            "id": "B0001.019"
        },
        {
            "parts": [
                "Process",
                "Create Mutex"
            ],
            "objective": "Process",
            "behavior": "Create Mutex",
            "method": "",
            "id": "C0042"
        },
        {
            "parts": [
                "Discovery",
                "File and Directory Discovery"
            ],
            "objective": "Discovery",
            "behavior": "File and Directory Discovery",
            "method": "",
            "id": "E1083"
        },
        {
            "parts": [
                "Operating System",
                "Registry",
                "Query Registry Value"
            ],
            "objective": "Operating System",
            "behavior": "Registry",
            "method": "Query Registry Value",
            "id": "C0036.006"
        },
        {
            "parts": [
                "Operating System",
                "Registry",
                "Query Registry Key"
            ],
            "objective": "Operating System",
            "behavior": "Registry",
            "method": "Query Registry Key",
            "id": "C0036.005"
        },
        {
            "parts": [
                "Operating System",
                "Registry",
                "Delete Registry Value"
            ],
            "objective": "Operating System",
            "behavior": "Registry",
            "method": "Delete Registry Value",
            "id": "C0036.007"
        },
        {
            "parts": [
                "Data",
                "Non-Cryptographic Hash",
                "FNV"
            ],
            "objective": "Data",
            "behavior": "Non-Cryptographic Hash",
            "method": "FNV",
            "id": "C0030.005"
        },
        {
            "parts": [
                "Operating System",
                "Registry",
                "Set Registry Key"
            ],
            "objective": "Operating System",
            "behavior": "Registry",
            "method": "Set Registry Key",
            "id": "C0036.001"
        },
        {
            "parts": [
                "Discovery",
                "System Information Discovery"
            ],
            "objective": "Discovery",
            "behavior": "System Information Discovery",
            "method": "",
            "id": "E1082"
        },
        {
            "parts": [
                "Anti-Behavioral Analysis",
                "Conditional Execution",
                "Runs as Service"
            ],
            "objective": "Anti-Behavioral Analysis",
            "behavior": "Conditional Execution",
            "method": "Runs as Service",
            "id": "B0025.007"
        }
    ],
    "capabilities": [
        {
            "name": "delay execution",
            "description": "",
            "references": [
                "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions",
                "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
            ],
            "authors": [
                "michael.hunhoff@mandiant.com",
                "@ramen0x3f"
            ]
        },
        {
            "name": "open process",
            "description": "",
            "references": [],
            "authors": [
                "0x534a@mailbox.org"
            ]
        },
        {
            "name": "create or open registry key",
            "description": "",
            "references": [],
            "authors": [
                "michael.hunhoff@mandiant.com",
                "anushka.virgaonkar@mandiant.com"
            ]
        },
        {
            "name": "encode data using XOR",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com"
            ]
        },
        {
            "name": "check Internet connectivity via WinINet",
            "description": "",
            "references": [],
            "authors": [
                "matthew.williams@mandiant.com",
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "PEB access",
            "description": "",
            "references": [
                "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
            ],
            "authors": [
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "contain loop",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com"
            ]
        },
        {
            "name": "parse PE header",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com"
            ]
        },
        {
            "name": "create mutex",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "print debug messages",
            "description": "",
            "references": [],
            "authors": [
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "link function at runtime on Windows",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "check if file exists",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "query or enumerate registry value",
            "description": "",
            "references": [],
            "authors": [
                "william.ballenthin@mandiant.com",
                "michael.hunhoff@mandiant.com",
                "anushka.virgaonkar@mandiant.com"
            ]
        },
        {
            "name": "query or enumerate registry key",
            "description": "",
            "references": [],
            "authors": [
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "delete registry value",
            "description": "",
            "references": [],
            "authors": [
                "michael.hunhoff@mandiant.com",
                "anushka.virgaonkar@mandiant.com"
            ]
        },
        {
            "name": "hash data using fnv",
            "description": "can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0",
            "references": [
                "https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function",
                "http://isthe.com/chongo/tech/comp/fnv/",
                "https://create.stephan-brumme.com/fnv-hash/"
            ],
            "authors": [
                "moritz.raabe@mandiant.com",
                "@_re_fox",
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "set registry value",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "get token membership",
            "description": "",
            "references": [],
            "authors": [
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "prompt user for credentials",
            "description": "",
            "references": [
                "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/credentials-collection-via-creduipromptforcredentials"
            ],
            "authors": [
                "michael.hunhoff@mandiant.com"
            ]
        },
        {
            "name": "extract resource via kernel32 functions",
            "description": "",
            "references": [],
            "authors": [
                "william.ballenthin@mandiant.com"
            ]
        },
        {
            "name": "get session user name",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "anushka.virgaonkar@mandiant.com"
            ]
        },
        {
            "name": "get hostname",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "joakim@intezer.com",
                "anushka.virgaonkar@mandiant.com"
            ]
        },
        {
            "name": "run as service",
            "description": "",
            "references": [],
            "authors": [
                "moritz.raabe@mandiant.com",
                "michael.hunhoff@mandiant.com"
            ]
        }
    ],
    "timestamp": "2024-03-02 23:45:28"
}