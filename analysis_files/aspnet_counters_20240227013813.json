{"meta": {"timestamp": "2024-02-27T01:38:11.214205", "version": "7.0.1", "argv": ["-r", "/opt/capa-rules-7.0.1/", "-j", "/tmp/aspnet_counters.dll"], "sample": {"md5": "3897af6e6a36c97b3dd2db1f9852e122", "sha1": "86f1596f1b0298c1aeff0024a0d4ad349a9f79c8", "sha256": "e8e884baf461abb536a94c3d99e759c49b18340bad9f715cc70b2b340b0e2aeb", "path": "/tmp/aspnet_counters.dll"}, "flavor": "static", "analysis": {"format": "pe", "arch": "amd64", "os": "windows", "extractor": "VivisectFeatureExtractor", "rules": ["/opt/capa-rules-7.0.1"], "base_address": {"type": "absolute", "value": 6442450944}, "layout": {"functions": [{"address": {"type": "absolute", "value": 6442455040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455040}}, {"address": {"type": "absolute", "value": 6442460088}}]}, {"address": {"type": "absolute", "value": 6442455088}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455088}}]}, {"address": {"type": "absolute", "value": 6442455128}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455256}}]}, {"address": {"type": "absolute", "value": 6442455284}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455284}}, {"address": {"type": "absolute", "value": 6442455318}}]}, {"address": {"type": "absolute", "value": 6442455328}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455344}}, {"address": {"type": "absolute", "value": 6442455354}}]}, {"address": {"type": "absolute", "value": 6442455376}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455392}}, {"address": {"type": "absolute", "value": 6442455402}}]}, {"address": {"type": "absolute", "value": 6442455424}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455440}}, {"address": {"type": "absolute", "value": 6442455450}}]}, {"address": {"type": "absolute", "value": 6442455472}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455517}}]}, {"address": {"type": "absolute", "value": 6442455536}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455581}}]}, {"address": {"type": "absolute", "value": 6442455600}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455645}}]}, {"address": {"type": "absolute", "value": 6442455664}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455678}}, {"address": {"type": "absolute", "value": 6442455723}}, {"address": {"type": "absolute", "value": 6442455742}}]}, {"address": {"type": "absolute", "value": 6442455760}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455774}}, {"address": {"type": "absolute", "value": 6442455785}}, {"address": {"type": "absolute", "value": 6442455822}}, {"address": {"type": "absolute", "value": 6442455841}}]}, {"address": {"type": "absolute", "value": 6442455856}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455870}}, {"address": {"type": "absolute", "value": 6442455918}}, {"address": {"type": "absolute", "value": 6442455937}}]}, {"address": {"type": "absolute", "value": 6442455944}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442455957}}, {"address": {"type": "absolute", "value": 6442455967}}]}, {"address": {"type": "absolute", "value": 6442455980}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456031}}]}, {"address": {"type": "absolute", "value": 6442456040}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456040}}, {"address": {"type": "absolute", "value": 6442456188}}]}, {"address": {"type": "absolute", "value": 6442456216}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456216}}]}, {"address": {"type": "absolute", "value": 6442456572}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456584}}, {"address": {"type": "absolute", "value": 6442456594}}]}, {"address": {"type": "absolute", "value": 6442456608}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442456721}}, {"address": {"type": "absolute", "value": 6442456830}}, {"address": {"type": "absolute", "value": 6442456990}}]}, {"address": {"type": "absolute", "value": 6442457032}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457072}}, {"address": {"type": "absolute", "value": 6442457132}}, {"address": {"type": "absolute", "value": 6442457164}}]}, {"address": {"type": "absolute", "value": 6442457300}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457354}}]}, {"address": {"type": "absolute", "value": 6442457368}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457368}}]}, {"address": {"type": "absolute", "value": 6442457460}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457368}}]}, {"address": {"type": "absolute", "value": 6442457492}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457492}}]}, {"address": {"type": "absolute", "value": 6442457528}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457547}}, {"address": {"type": "absolute", "value": 6442457558}}]}, {"address": {"type": "absolute", "value": 6442457564}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457564}}, {"address": {"type": "absolute", "value": 6442457750}}, {"address": {"type": "absolute", "value": 6442457779}}]}, {"address": {"type": "absolute", "value": 6442457848}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457848}}, {"address": {"type": "absolute", "value": 6442457918}}, {"address": {"type": "absolute", "value": 6442457959}}]}, {"address": {"type": "absolute", "value": 6442457964}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457997}}]}, {"address": {"type": "absolute", "value": 6442458020}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458072}}]}, {"address": {"type": "absolute", "value": 6442458080}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458163}}]}, {"address": {"type": "absolute", "value": 6442458668}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458959}}]}, {"address": {"type": "absolute", "value": 6442458976}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442458959}}, {"address": {"type": "absolute", "value": 6442458976}}, {"address": {"type": "absolute", "value": 6442459009}}]}, {"address": {"type": "absolute", "value": 6442459352}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442459387}}]}, {"address": {"type": "absolute", "value": 6442460088}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442460088}}]}, {"address": {"type": "absolute", "value": 6442460696}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442460736}}, {"address": {"type": "absolute", "value": 6442460745}}]}, {"address": {"type": "absolute", "value": 6442460756}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442460796}}, {"address": {"type": "absolute", "value": 6442460805}}]}, {"address": {"type": "absolute", "value": 6442461830}, "matched_basic_blocks": [{"address": {"type": "absolute", "value": 6442457368}}, {"address": {"type": "absolute", "value": 6442461830}}]}]}, "feature_counts": {"file": 559, "functions": [{"address": {"type": "absolute", "value": 6442455040}, "count": 23}, {"address": {"type": "absolute", "value": 6442455088}, "count": 13}, {"address": {"type": "absolute", "value": 6442455120}, "count": 7}, {"address": {"type": "absolute", "value": 6442455128}, "count": 39}, {"address": {"type": "absolute", "value": 6442455284}, "count": 26}, {"address": {"type": "absolute", "value": 6442455328}, "count": 17}, {"address": {"type": "absolute", "value": 6442455376}, "count": 17}, {"address": {"type": "absolute", "value": 6442455424}, "count": 17}, {"address": {"type": "absolute", "value": 6442455472}, "count": 20}, {"address": {"type": "absolute", "value": 6442455536}, "count": 20}, {"address": {"type": "absolute", "value": 6442455600}, "count": 20}, {"address": {"type": "absolute", "value": 6442455664}, "count": 23}, {"address": {"type": "absolute", "value": 6442455760}, "count": 25}, {"address": {"type": "absolute", "value": 6442455856}, "count": 24}, {"address": {"type": "absolute", "value": 6442455944}, "count": 21}, {"address": {"type": "absolute", "value": 6442455980}, "count": 28}, {"address": {"type": "absolute", "value": 6442456040}, "count": 50}, {"address": {"type": "absolute", "value": 6442456216}, "count": 86}, {"address": {"type": "absolute", "value": 6442456572}, "count": 21}, {"address": {"type": "absolute", "value": 6442456608}, "count": 93}, {"address": {"type": "absolute", "value": 6442457032}, "count": 56}, {"address": {"type": "absolute", "value": 6442457220}, "count": 7}, {"address": {"type": "absolute", "value": 6442457296}, "count": 8}, {"address": {"type": "absolute", "value": 6442457300}, "count": 26}, {"address": {"type": "absolute", "value": 6442457368}, "count": 37}, {"address": {"type": "absolute", "value": 6442457460}, "count": 49}, {"address": {"type": "absolute", "value": 6442457492}, "count": 23}, {"address": {"type": "absolute", "value": 6442457528}, "count": 28}, {"address": {"type": "absolute", "value": 6442457564}, "count": 72}, {"address": {"type": "absolute", "value": 6442457800}, "count": 27}, {"address": {"type": "absolute", "value": 6442457848}, "count": 44}, {"address": {"type": "absolute", "value": 6442457964}, "count": 23}, {"address": {"type": "absolute", "value": 6442458020}, "count": 21}, {"address": {"type": "absolute", "value": 6442458080}, "count": 39}, {"address": {"type": "absolute", "value": 6442458976}, "count": 64}, {"address": {"type": "absolute", "value": 6442459352}, "count": 20}, {"address": {"type": "absolute", "value": 6442460284}, "count": 10}, {"address": {"type": "absolute", "value": 6442460300}, "count": 10}, {"address": {"type": "absolute", "value": 6442460312}, "count": 7}, {"address": {"type": "absolute", "value": 6442460348}, "count": 7}, {"address": {"type": "absolute", "value": 6442460356}, "count": 9}, {"address": {"type": "absolute", "value": 6442460696}, "count": 34}, {"address": {"type": "absolute", "value": 6442460756}, "count": 34}, {"address": {"type": "absolute", "value": 6442461654}, "count": 8}, {"address": {"type": "absolute", "value": 6442461666}, "count": 8}, {"address": {"type": "absolute", "value": 6442461672}, "count": 8}, {"address": {"type": "absolute", "value": 6442461684}, "count": 8}, {"address": {"type": "absolute", "value": 6442461690}, "count": 8}, {"address": {"type": "absolute", "value": 6442461696}, "count": 8}, {"address": {"type": "absolute", "value": 6442461702}, "count": 8}, {"address": {"type": "absolute", "value": 6442461714}, "count": 8}, {"address": {"type": "absolute", "value": 6442461720}, "count": 8}, {"address": {"type": "absolute", "value": 6442461760}, "count": 9}, {"address": {"type": "absolute", "value": 6442461764}, "count": 7}, {"address": {"type": "absolute", "value": 6442461824}, "count": 8}, {"address": {"type": "absolute", "value": 6442461830}, "count": 54}, {"address": {"type": "absolute", "value": 6442462016}, "count": 9}]}, "library_functions": [{"address": {"type": "absolute", "value": 6442457228}, "name": "?AmGetLastErrorToHResult@@YAJXZ"}, {"address": {"type": "absolute", "value": 6442457272}, "name": "?"}, {"address": {"type": "absolute", "value": 6442458176}, "name": "?dllmain_crt_dispatch@@YAHQEAUHINSTANCE__@@KQEAX@Z"}, {"address": {"type": "absolute", "value": 6442458256}, "name": "?dllmain_crt_process_attach@@YAHQEAUHINSTANCE__@@QEAX@Z"}, {"address": {"type": "absolute", "value": 6442458536}, "name": "?dllmain_crt_process_detach@@YAH_N@Z"}, {"address": {"type": "absolute", "value": 6442458668}, "name": "?dllmain_dispatch@@YAHQEAUHINSTANCE__@@KQEAX@Z"}, {"address": {"type": "absolute", "value": 6442459040}, "name": "__GSHandlerCheck"}, {"address": {"type": "absolute", "value": 6442459072}, "name": "__GSHandlerCheckCommon"}, {"address": {"type": "absolute", "value": 6442459184}, "name": "__security_check_cookie"}, {"address": {"type": "absolute", "value": 6442459216}, "name": "__scrt_acquire_startup_lock"}, {"address": {"type": "absolute", "value": 6442459276}, "name": "__scrt_dllmain_after_initialize_c"}, {"address": {"type": "absolute", "value": 6442459328}, "name": "__scrt_dllmain_before_initialize_c"}, {"address": {"type": "absolute", "value": 6442459392}, "name": "__scrt_dllmain_crt_thread_detach"}, {"address": {"type": "absolute", "value": 6442459416}, "name": "__scrt_dllmain_exception_filter"}, {"address": {"type": "absolute", "value": 6442459512}, "name": "__scrt_dllmain_uninitialize_c"}, {"address": {"type": "absolute", "value": 6442459560}, "name": "__scrt_dllmain_uninitialize_critical"}, {"address": {"type": "absolute", "value": 6442459580}, "name": "__scrt_initialize_crt"}, {"address": {"type": "absolute", "value": 6442459656}, "name": "__scrt_initialize_onexit_tables"}, {"address": {"type": "absolute", "value": 6442459796}, "name": "__scrt_is_nonwritable_in_current_image"}, {"address": {"type": "absolute", "value": 6442459948}, "name": "__scrt_release_startup_lock"}, {"address": {"type": "absolute", "value": 6442459984}, "name": "__scrt_uninitialize_crt"}, {"address": {"type": "absolute", "value": 6442460028}, "name": "_onexit"}, {"address": {"type": "absolute", "value": 6442460088}, "name": "atexit"}, {"address": {"type": "absolute", "value": 6442460112}, "name": "__security_init_cookie"}, {"address": {"type": "absolute", "value": 6442460320}, "name": "__scrt_initialize_default_local_stdio_options"}, {"address": {"type": "absolute", "value": 6442460364}, "name": "__scrt_fastfail"}, {"address": {"type": "absolute", "value": 6442460816}, "name": "__raise_securityfailure"}, {"address": {"type": "absolute", "value": 6442460880}, "name": "__report_gsfailure"}, {"address": {"type": "absolute", "value": 6442461092}, "name": "capture_previous_context"}, {"address": {"type": "absolute", "value": 6442461208}, "name": "__isa_available_init"}, {"address": {"type": "absolute", "value": 6442461628}, "name": "?"}, {"address": {"type": "absolute", "value": 6442461636}, "name": "_Curl_tls_keylog_enabled"}, {"address": {"type": "absolute", "value": 6442461728}, "name": "?initialize_legacy_wide_specifiers@@YAHXZ"}, {"address": {"type": "absolute", "value": 6442461792}, "name": "_guard_dispatch_icall_nop"}, {"address": {"type": "absolute", "value": 6442461857}, "name": "?fin$0@?0??dllmain_crt_process_attach@@YAHQEAUHINSTANCE__@@QEAX@Z@4HA"}, {"address": {"type": "absolute", "value": 6442461880}, "name": "?fin$0@?0??dllmain_crt_process_detach@@YAH_N@Z@4HA"}, {"address": {"type": "absolute", "value": 6442461905}, "name": "?fin$1@?0??dllmain_crt_process_detach@@YAH_N@Z@4HA"}, {"address": {"type": "absolute", "value": 6442461925}, "name": "?filt$0@?0??dllmain_dispatch@@YAHQEAUHINSTANCE__@@KQEAX@Z@4HA"}, {"address": {"type": "absolute", "value": 6442461979}, "name": "__scrt_is_nonwritable_in_current_image$filt$0"}]}}, "rules": {"create or open registry key": {"meta": {"name": "create or open registry key", "authors": ["michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scopes": {"static": "basic block", "dynamic": "call"}, "attack": [], "mbc": [{"parts": ["Operating System", "Registry", "Create Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Create Registry Key", "id": "C0036.004"}, {"parts": ["Operating System", "Registry", "Open Registry Key"], "objective": "Operating System", "behavior": "Registry", "method": "Open Registry Key", "id": "C0036.003"}], "references": [], "examples": ["Practical Malware Analysis Lab 03-02.dll_:0x10004706", "Practical Malware Analysis Lab 11-01.exe_:0x401000", "493167E85E45363D09495D0841C30648:0x404D60", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E", "692f7fd6d198e804d6af98eb9e390d61:0x6000003"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n", "matches": [[{"type": "absolute", "value": 6442456830}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenKey"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenKeyEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442456861}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegCreateKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegCreateKeyEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenCurrentUser"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenUserClassesRoot"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegCreateKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKeyEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtOpenKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegOpenUSKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegCreateUSKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlCreateRegistryKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "delay execution": {"meta": {"name": "delay execution", "authors": ["michael.hunhoff@mandiant.com", "@ramen0x3f"], "scopes": {"static": "basic block", "dynamic": "call"}, "attack": [], "mbc": [{"parts": ["Anti-Behavioral Analysis", "Dynamic Analysis Evasion", "Delayed Execution"], "objective": "Anti-Behavioral Analysis", "behavior": "Dynamic Analysis Evasion", "method": "Delayed Execution", "id": "B0003.003"}], "references": ["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions", "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"], "examples": ["al-khaser_x86.exe_:0x449770", "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n", "matches": [[{"type": "absolute", "value": 6442457547}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "os", "os": "linux"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "sleep"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "usleep"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "Sleep"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457549}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SleepEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SignalObjectAndWait"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForSingleObjectEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegisterWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "WaitOnAddress"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjects"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "MsgWaitForMultipleObjectsEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtDelayExecution"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeWaitForSingleObject"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "KeDelayExecutionThread"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "link function at runtime on Windows": {"meta": {"name": "link function at runtime on Windows", "namespace": "linking/runtime-linking", "authors": ["moritz.raabe@mandiant.com", "michael.hunhoff@mandiant.com"], "scopes": {"static": "function"}, "attack": [{"parts": ["Execution", "Shared Modules"], "tactic": "Execution", "technique": "Shared Modules", "subtechnique": "", "id": "T1129"}], "mbc": [], "references": [], "examples": ["9324D1A8AE37A36AE560C37448C9705A:0x404130", "Practical Malware Analysis Lab 01-04.exe_:0x401350"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n", "matches": [[{"type": "absolute", "value": 6442456216}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "os", "os": "windows"}}, "children": [], "locations": [{"type": "no address"}], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "GetProcAddress"}}, "children": [], "locations": [{"type": "absolute", "value": 6442456489}, {"type": "absolute", "value": 6442456466}, {"type": "absolute", "value": 6442456444}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LdrGetProcedureAddress"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "indirect call"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "LoadLibrary"}}, "children": [], "locations": [{"type": "absolute", "value": 6442456422}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetModuleHandle"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "GetModuleHandleEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "LdrLoadDll"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "contain loop": {"meta": {"name": "contain loop", "authors": ["moritz.raabe@mandiant.com"], "scopes": {"static": "function"}, "attack": [], "mbc": [], "references": [], "examples": ["08AC667C65D36D6542917655571E61C8:0x406EAA"], "description": "", "lib": true, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n", "matches": [[{"type": "absolute", "value": 6442456608}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442456608}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457032}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457032}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457368}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457426}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457460}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457426}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457564}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457564}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442457848}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457941}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442458080}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442458139}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460696}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460696}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442460756}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442460756}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], [{"type": "absolute", "value": 6442461830}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "loop"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "tight loop"}}, "children": [], "locations": [{"type": "absolute", "value": 6442457426}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "characteristic", "characteristic": "recursive call"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}, "query or enumerate registry value": {"meta": {"name": "query or enumerate registry value", "namespace": "host-interaction/registry", "authors": ["william.ballenthin@mandiant.com", "michael.hunhoff@mandiant.com", "anushka.virgaonkar@mandiant.com"], "scopes": {"static": "function", "dynamic": "thread"}, "attack": [{"parts": ["Discovery", "Query Registry"], "tactic": "Discovery", "technique": "Query Registry", "subtechnique": "", "id": "T1012"}], "mbc": [{"parts": ["Operating System", "Registry", "Query Registry Value"], "objective": "Operating System", "behavior": "Registry", "method": "Query Registry Value", "id": "C0036.006"}], "references": [], "examples": ["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A", "Practical Malware Analysis Lab 03-02.dll_:0x100047AD"], "description": "", "lib": false, "is_subscope_rule": false, "maec": {}}, "source": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n", "matches": [[{"type": "absolute", "value": 6442456608}, {"success": true, "node": {"type": "statement", "statement": {"type": "and"}}, "children": [{"success": true, "node": {"type": "statement", "statement": {"type": "optional"}}, "children": [{"success": true, "node": {"type": "feature", "feature": {"type": "match", "match": "create or open registry key"}}, "children": [{"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenKey"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenKeyEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442456861}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegCreateKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegCreateKeyEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenCurrentUser"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegOpenUserClassesRoot"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegCreateKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKeyEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwOpenKeyTransactedEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwCreateKeyTransacted"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtOpenKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtCreateKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegOpenUSKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegCreateUSKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlCreateRegistryKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenSubKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenBaseKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::CreateSubKey"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [{"type": "absolute", "value": 6442456830}], "captures": {}}], "locations": [], "captures": {}}, {"success": true, "node": {"type": "statement", "statement": {"type": "or"}}, "children": [{"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegGetValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegEnumValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegQueryValue"}}, "children": [], "locations": [], "captures": {}}, {"success": true, "node": {"type": "feature", "feature": {"type": "api", "api": "RegQueryValueEx"}}, "children": [], "locations": [{"type": "absolute", "value": 6442456920}], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RegQueryMultipleValues"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwQueryValueKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "ZwEnumerateValueKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtQueryValueKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "NtEnumerateValueKey"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "RtlQueryRegistryValues"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHGetValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHEnumValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetInt"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetPath"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHQueryValueEx"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetUSValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHOpenRegStream"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegEnumUSValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHOpenRegStream2"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegQueryUSValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetBoolUSValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetValueFromHKCUHKLM"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "SHRegGetBoolValueFromHKCUHKLM"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValue"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueKind"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.RegistryKey::GetValueNames"}}, "children": [], "locations": [], "captures": {}}, {"success": false, "node": {"type": "feature", "feature": {"type": "api", "api": "Microsoft.Win32.Registry::GetValue"}}, "children": [], "locations": [], "captures": {}}], "locations": [], "captures": {}}], "locations": [], "captures": {}}]]}}}